# Migration `20200502165817-20-05-07--fix-schema---table-name-convention`

This migration has been generated by dnatuna at 5/2/2020, 4:58:17 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `habit_bread`.`characters` DROP FOREIGN KEY `fk_Character_User1`;

ALTER TABLE `habit_bread`.`commit_history` DROP FOREIGN KEY `fk_Habit_History_Habit1`,
DROP FOREIGN KEY `fk_Habit_History_User1`;

ALTER TABLE `habit_bread`.`user_habit` DROP FOREIGN KEY `fk_User_Habit_Habit1`,
DROP FOREIGN KEY `fk_User_Habit_User1`;

ALTER TABLE `habit_bread`.`characters` ADD FOREIGN KEY (`user_id`) REFERENCES `habit_bread`.`users`(`user_id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `habit_bread`.`commit_history` ADD FOREIGN KEY (`habit_id`) REFERENCES `habit_bread`.`habits`(`habit_id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `habit_bread`.`commit_history` ADD FOREIGN KEY (`user_id`) REFERENCES `habit_bread`.`users`(`user_id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `habit_bread`.`user_habit` ADD FOREIGN KEY (`habit_id`) REFERENCES `habit_bread`.`habits`(`habit_id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `habit_bread`.`user_habit` ADD FOREIGN KEY (`user_id`) REFERENCES `habit_bread`.`users`(`user_id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200502054700-add-user---name--email..20200502165817-20-05-07--fix-schema---table-name-convention
--- datamodel.dml
+++ datamodel.dml
@@ -1,14 +1,90 @@
-datasource mysql {
-  url = "***"
-  provider = "mysql"
-}
-
-generator client {
-  provider = "prisma-client-js"
-}
-
-model User {
-  id           Int       @id @default(autoincrement())
-  name         String?
-  email        String    @unique
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource mysql {
+  provider = "mysql"
+  url      = env("DB_URL")
+}
+
+model Character {
+  character_id Int   @id
+  exp          Int   @default(0)
+  user_id      Int
+  users        User @relation(fields: [user_id], references: [user_id])
+
+  @@index([user_id], name: "fk_Character_User1_idx")
+  @@map("characters")
+}
+
+model CommitHistory {
+  created_at DateTime @default(now())
+  habit_id   Int
+  history_id Int      @default(autoincrement()) @id
+  user_id    Int
+  habits     Habit   @relation(fields: [habit_id], references: [habit_id])
+  users      User    @relation(fields: [user_id], references: [user_id])
+
+  @@index([habit_id], name: "fk_Habit_History_Habit1_idx")
+  @@index([user_id], name: "fk_Habit_History_User1_idx")
+  @@map("commit_history")
+}
+
+model Habit {
+  category       String
+  description    String?
+  habit_id       Int              @default(autoincrement()) @id
+  is_scheduled   Int
+  title          String
+  commit_history CommitHistory[]
+  user_habit     UserHabit[]
+
+  @@map("habits")
+}
+
+model Ranking {
+  exp        Int
+  ranking_id Int    @id
+  user_name  String
+
+  @@map("ranking")
+}
+
+model Scheduler {
+  habit_alarm_at DateTime
+  habit_id       String
+  habit_title    String
+  habit_type     Int
+  schedule_id    Int      @id
+  user_id        String
+
+  @@map("scheduler")
+}
+
+model User {
+  apple_id       String?
+  created_at     DateTime?
+  email          String
+  google_id      String?
+  image_url      String?
+  name           String
+  updated_at     DateTime?
+  user_id        Int              @default(autoincrement()) @id
+  characters     Character[]
+  commit_history CommitHistory[]
+  user_habit     UserHabit[]
+
+  @@map("users")
+}
+
+model UserHabit {
+  habit_id Int
+  user_id  Int
+  habits   Habit @relation(fields: [habit_id], references: [habit_id])
+  users    User  @relation(fields: [user_id], references: [user_id])
+
+  @@id([user_id, habit_id])
+  @@index([habit_id], name: "fk_User_Habit_Habit1_idx")
+  @@index([user_id], name: "fk_User_Habit_User1_idx")
+  @@map("user_habit")
 }
```


